import{r as v,_ as y,u as C,a as T,b as d,o as V,c as S,d as w,e as l,w as m,f as i,i as k,g as f,t as B,C as I}from"./index.41781111.js";const L="ms_count_down_data_key";function D(u=L){const t=v({value:0,endTime:0});function c(){try{const e=JSON.parse(localStorage.getItem(u))||{};if(!e.value||!e.endTime||e.endTime<=Date.now())return o(),"\u8BA1\u65F6\u5668\u5DF2\u7ECF\u5230\u671F\u4E86";const s=Math.floor((e.endTime-Date.now())/1e3);if(s<=0)return"\u8BA1\u65F6\u5668\u4E0D\u8DB31s\u4E86";t.endTime=e.endTime,a(s,!1)}catch{}}function o(){a(0,!1)}function a(e,s=!0){if(e&&(t.value=e,s&&(t.endTime=e*1e3+Date.now())),t.value<=0){localStorage.removeItem(u);return}localStorage.setItem(u,JSON.stringify(t)),setTimeout(()=>{t.value--,a()},1e3)}return{start:a,clear:o,recover:c,data:t}}var N="./assets/wx_logo.57285768.png";const U={class:"tw-pt-40 tw-px-20"},$={class:"tw-pt-24 tw-px-20 tw-rounded-12 tw-bg-white"},q={class:"tw-pt-50 tw-w-full"},E=f(" \u7ACB\u5373\u767B\u5F55 "),W=f("\u6216\u8005"),z={class:"row-flex-center tw-pb-50 tw-w-full"},A={name:"Login",setup(u){const t=C(),c=T(),o=D();o.recover();const a=async()=>{if(o.data.value>0)return;await c.sendCode(e.phone)&&o.start(60)},e=v({phone:"",code:""}),s=()=>{const r=I.wxAppId,n=window.location.href.replace(window.location.search,""),p=encodeURIComponent(n);window.location.href=`https://open.weixin.qq.com/connect/oauth2/authorize?appid=${r}&redirect_uri=${p}&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect`};return(()=>{const r=t.query.code;k(r)||c.wxLogin(r)})(),(r,n)=>{const p=d("van-field"),g=d("van-button"),h=d("VanButton"),b=d("van-divider"),x=d("van-image");return V(),S("div",U,[w("div",$,[l(p,{class:"tw-border-b tw-border-gray-100",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",type:"tel",maxlength:"11",modelValue:e.phone,"onUpdate:modelValue":n[0]||(n[0]=_=>e.phone=_),label:"\u624B\u673A\u53F7\u7801"},null,8,["modelValue"]),l(p,{class:"tw-border-b tw-border-gray-100",placeholder:"\u9A8C\u8BC1\u7801",type:"number",modelValue:e.code,"onUpdate:modelValue":n[1]||(n[1]=_=>e.code=_),maxlength:"6",label:"\u9A8C\u8BC1\u7801"},{button:m(()=>[l(g,{disabled:i(o).data.value>0,onClick:a,size:"mini",type:"primary"},{default:m(()=>[f(B(i(o).data.value>0?`${i(o).data.value}s\u540E\u91CD\u65B0\u83B7\u53D6`:"\u53D1\u9001\u9A8C\u8BC1\u7801"),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"]),w("div",q,[l(h,{onClick:n[2]||(n[2]=_=>i(c).login(e.phone,e.code)),type:"danger",round:"",block:""},{default:m(()=>[E]),_:1})]),l(b,null,{default:m(()=>[W]),_:1}),w("div",z,[l(x,{onClick:s,src:i(N),class:"tw-w-50 tw-h-auto"},null,8,["src"])])])])}}};var O=y(A,[["__scopeId","data-v-604d0ba6"]]);export{O as default};
